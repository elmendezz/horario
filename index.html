<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="theme-color" content="#6200ea"/>
    <link rel="manifest" href="manifest.json">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Horario 1CV">
    <link rel="apple-touch-icon" href="images/icons/apple-touch-icon.png">
    <title>Horario 1CV - SalÃ³n C2/CÃ³mputo 2</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button id="theme-toggle" aria-label="Cambiar tema">ðŸŒ‘</button>
    <button id="notifications-btn" aria-label="Activar notificaciones">ðŸ”•</button>
    <button id="chat-btn" aria-label="Abrir mensajes">ðŸ’¬</button>
    <div class="container">
        <div id="current-class-display">Cargando horario...</div>
        <div id="teacher-display"></div>
        <button id="next-class-display">Siguiente clase: Cargando...</button>
    </div>
    
    <div id="clock"></div>
    <div id="countdown"></div>
    <div id="aviso"> â“˜ Esta Web App EstÃ¡ En Desarrollo...</div>

    <div class="button-group">
        <button id="show-schedule-btn" class="styled-button">Mostrar Horario Completo</button>
        <button id="fullscreen-btn" class="styled-button">Pantalla Completa</button>
        <a href="about-us.html" class="styled-button" style="background-color: #FFD700; color: #000;">About Us</a>
    </div>

    <!-- Contenedor para herramientas de desarrollo, oculto por defecto -->
    <div id="developer-tools" class="button-group" style="display: none; margin-top: 1em;">
        <a href="time.html" class="styled-button" style="background-color: #17a2b8;">Simular Hora</a>
        <button id="test-notification-btn" class="styled-button" style="background-color: #ffc107; color: #000;">Probar NotificaciÃ³n (5s)</button>
        <a href="test.html" class="styled-button" style="background-color: #fd7e14;">Panel de Pruebas</a>
        <a href="messages.html" class="styled-button" style="background-color: #007bff;">Mensajes Beta</a>
        <a href="verify.html" class="styled-button" style="background-color: #28a745;">Verificar Usuarios</a>
    </div>

    <div id="ios-install-prompt">
        Para recibir notificaciones, aÃ±ade esta pÃ¡gina a tu pantalla de inicio: Toca el icono de <strong>Compartir</strong> y luego <strong>"Agregar a la pantalla de inicio"</strong>.
    </div>

    <div class="table-wrapper">
        <table id="schedule-table">
            <thead>
                <tr>
                    <th>Hora</th>
                    <th>Lunes</th>
                    <th>Martes</th>
                    <th>MiÃ©rcoles</th>
                    <th>Jueves</th>
                    <th>Viernes</th>
                </tr>
            </thead>
            <tbody id="schedule-table-body">
            </tbody>
        </table>
    </div>

    <!-- BotÃ³n para mostrar las herramientas de desarrollo -->
    <div style="margin-top: 2em; text-align: center;">
        <button id="show-dev-tools-btn" class="styled-button" style="background-color: #6c757d; font-size: 0.7em; padding: 8px 15px;">Mostrar Botones de Desarrollo</button>
    </div>

    <div id="imageModal" class="modal">
        <div class="modal-content">
            <a href="horario.jpg" target="_blank">
                <img id="modalImage" src="horario.jpg" alt="Horario 1CV">
            </a>
            <div class="modal-footer">
                <button id="closeModalBtn">Aceptar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para solicitar el nombre de usuario -->
    <div id="name-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <h2>Â¡Bienvenido/a!</h2>
            <p>Para poder enviar mensajes, por favor dinos tu nombre. Este nombre serÃ¡ visible para otros.</p>
            <form id="name-form" style="margin-top: 1em;">
                <input type="text" id="username-input" placeholder="Tu nombre o apodo" required style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box;">
                <div class="modal-footer">
                    <button type="submit" id="save-name-btn">Guardar Nombre</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para el Chat -->
    <div id="chat-modal" class="modal">
        <div class="modal-content" style="max-width: 800px; height: 80vh; display: flex; flex-direction: column;">
            <div class="messages-container" style="flex-grow: 1; display: flex; flex-direction: column; overflow: hidden;">
                <h1 style="color: var(--accent-color); text-align: center; margin-top: 0;">Mensajes Beta ðŸ“£</h1>
                
                <div id="messages-list" style="flex-grow: 1; overflow-y: auto; padding-right: 10px;">
                    <div class="loading-spinner">ðŸ”„ Cargando mensajes...</div>
                </div>

                <div class="message-form" style="margin-top: 1em;">
                    <form id="new-message-form">
                        <textarea id="message-text" placeholder="Escribe tu mensaje aquÃ­..." required></textarea>
                        <button type="submit" class="styled-button">Enviar Mensaje</button>
                        <p id="chat-status-message" style="font-size: 0.8em; text-align: center; margin-top: 10px; color: #ffc107;"></p>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    
    <script>
        if ('serviceWorker' in navigator) {
          window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
              .then(reg => console.log('ServiceWorker registrado:', reg.scope))
              .catch(err => console.log('Fallo en registro de ServiceWorker:', err));
          });
        }
    </script>

</body>
</html>